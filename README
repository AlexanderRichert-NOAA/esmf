 $Id: README,v 1.32 2003/09/02 17:11:09 cdeluca Exp $
================================================================================
                                   README

                    Earth System Modeling Framework (ESMF)

================================================================================

README file for ESMF v1.0.2 release.

The files contained here include the ESMF source code and build system.

More information about the ESMF project can be found at the ESMF web site:
        
        http://www.esmf.ucar.edu

For additional documentation on building and running the ESMF please
see the ESMF User's Guide on the ESMF web site, under the "Downloads &
Documentation" link.

The ESMF library source code is also available for download at:

  http://sourceforge.net/cvs/?group_id=38089

Follow the directions on that webpage to access the ESMF CVS repository.

================================================================================

QuickStart information for the impatient.

 - set environment variable (see below).
 - Type 'gmake' (the GNU make program) to build the ESMF library.
 - Type 'gmake tests' to make and run the unit tests
    (or 'gmake tests_uni' for non-mpi machines).
 - Type 'gmake system_tests' to make and run the system tests
    (or 'gmake system_tests_uni' for non-mpi machines).
 - Type 'gmake ESMF_COUPLED_FLOW' to compile and run a coupled fluid flow 
   demo program.  It will run in parallel, 4-way, compute 3600 time steps, and
   produce 10 data dumps.


================================================================================

Directories
-----------

CVS:             Contains the CVSROOT information.

build &
build_config:    Contains the build system.

scripts:         Contains scripts for testing and uniprocessor runs, and some
                 templates.

src:             Contains the source code.

In addition, the following directories are created during the building
and testing stages:

doc:             Contains documentation (if built).

lib:             Contains the ESMF libraries.

mod:             Contains the Fortran module files.

test:            Contains unit and system test executables and output.


System Information
------------------

The following platforms are supported: Alpha, IRIX64, IBM 32-bit and
64-bit addressing.


Environment Variables
---------------------

Currently the ESMF_DIR environment variable must be set on all
platforms.  ESMF_DIR should be set to the path of the top
level ESMF directory.  

The following environment variables need to be set only if the
default values are not acceptable.  For supported platforms,
the default values should be all that is needed.

ESMF_ARCH      Normally value of uname -s.

ESMF_SITE      Build configure site name or the value default.
               If not set, then the value of default is assumed.

ESMF_PREC      Precision value of 32 or 64.  When possible the default
               value will be 64, otherwise it will be 32.

ESMF_BOPT      Build option value of g (for debug) or O (for Optimize). 
               Default value will be O.

The README file in the directory build_config documents these
variables in more detail, as does the ESMF User's Guide.

Environment variables must be set in the user's shell and not inside
an ESMF makefile or build system file.  They can also be set on the
gmake command line.  Here is an example of setting an environment
variable in tcsh and csh shells:

        setenv ESMF_PREC 32

In ksh shell environment variables are set this way:

        export ESMF_PREC=32

Example of setting variables on the gmake command line:

        gmake ESMF_PREC=32

Platform notes:

Compaq alpha - Before running on the Compaq, you will need to set the
environment variable ESMF_PROJECT to a valid project number suitable
for the -P option on bsub. If you do not know what to set this to
first run with it unset and you should be prompted by the system for
valid values for your userid.

IBM rs6000 - Before running on rs6000 machines, you will need to set
an additional environment variable MP_RMPOOL to a valid node
allocation pool.  Usually this will be a value of 1.


Build Information
-----------------

GNU make is required to build the library.  On most systems this will
be just the command gmake.  On others it might be installed as gnumake
or even just make.  In any event, use the --version option with these
make commands to determine which is GNU make.

Build the library with the command:
 
  gmake ESMF_BOPT=g 

for a debug version or

  gmake ESMF_BOPT=O

for an optimized version.

To build and run the coupled fluid flow demo:

  gmake ESMF_BOPT=[g,O] ESMF_COUPLED_FLOW

To build and run the system tests:

  gmake ESMF_BOPT=[g,O] system_tests
  gmake ESMF_BOPT=[g,O] system_tests_uni   ! for non-mpi machines

To build and run the unit tests:

  gmake ESMF_BOPT=[g,O] tests
  gmake ESMF_BOPT=[g,O] tests_uni          ! for non-mpi machines

To build and run the unit tests in exhaustive mode:

  gmake ESMF_BOPT=[g,O] ESMF_EXHAUSTIVE=ON tests
  gmake ESMF_BOPT=[g,O] ESMF_EXHAUSTIVE=ON tests_uni    ! for non-mpi machines

The exhaustive unit tests option is a *compile* time option.  Use

  gmake clean 

first if the unit tests have already been compiled without the
ESMF_EXHAUSTIVE=ON option.

Output files from the tests are directed to files in
${ESMF_DIR}/test/test${ESMF_BOPT}/${ESMF_ARCH}.$(ESMF_PREC).$(ESMF_SITE)
directories.

To build documentation:

  gmake pdf           ! Makes the pdf files
  gmake html          ! Creates the html directory.
  gmake alldoc        ! Builds all the above documents.

Final documentation files will be located in the ${ESMF_DIR}/doc
directory.  If these doc build commands are used on a Linux machine,
set the environment variable ESFM_SITE to the value of lahey.

Usage
-----

To use ESMF from Fortran, add the directory that contains
the ESMF *.mod file(s),

${ESMF_DIR}/mod/mod${ESMF_BOPT}/${ESMF_ARCH}.$(ESMF_PREC).$(ESMF_SITE)

to your search path for *.mod files.  For most compilers this path is
identified either with a -I or a -M.  You must also link with the ESMF
shared object library.  This is a file called libesmf.so that is
located in the following directory:

${ESMF_DIR}/lib/lib${ESMF_BOPT}/${ESMF_ARCH}.$(ESMF_PREC).$(ESMF_SITE)

There is a single ESMF module, called ESMF_Mod, that should be
included in applications with the Fortran USE statement.  It is not
necessary to include any header files in Fortran.

To use ESMF from C/C++, link with the ESMF shared object library and
include the ESMC.h file.

If you prefer standard libraries, a *.a file is provided in the same
library directory as the shared object file.

For information on how to link with shared libraries on a particular
platform, please see the ESMF User's Guide on the ESMF web site, under
the "Downloads & Documentation" link.
 
================================================================================

The latest documentation for the project can be found at:
http://www.esmf.ucar.edu -> Downloads & Documentation

The documentation at this site is for the latest release.  To obtain
the documentation that exactly matches this version, follow the
documentation build procedures outlined above.

Please contact esmf_support@ucar.edu with any questions or problems.

================================================================================

