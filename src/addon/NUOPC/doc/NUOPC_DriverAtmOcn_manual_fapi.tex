%                **** IMPORTANT NOTICE *****
% This LaTeX file has been automatically produced by ProTeX v. 1.1
% Any changes made to this file will likely be lost next time
% this file is regenerated from its source. Send questions 
% to Arlindo da Silva, dasilva@gsfc.nasa.gov
 
\setlength{\parskip}{0pt}
\setlength{\parindent}{0pt}
\setlength{\baselineskip}{11pt}
 
%--------------------- SHORT-HAND MACROS ----------------------
\def\bv{\begin{verbatim}}
\def\ev{\end{verbatim}}
\def\be{\begin{equation}}
\def\ee{\end{equation}}
\def\bea{\begin{eqnarray}}
\def\eea{\end{eqnarray}}
\def\bi{\begin{itemize}}
\def\ei{\end{itemize}}
\def\bn{\begin{enumerate}}
\def\en{\end{enumerate}}
\def\bd{\begin{description}}
\def\ed{\end{description}}
\def\({\left (}
\def\){\right )}
\def\[{\left [}
\def\]{\right ]}
\def\<{\left  \langle}
\def\>{\right \rangle}
\def\cI{{\cal I}}
\def\diag{\mathop{\rm diag}}
\def\tr{\mathop{\rm tr}}
%-------------------------------------------------------------

\markboth{Left}{Source File: NUOPC\_DriverAtmOcn.F90,  Date: Mon Mar 28 16:35:43 PDT 2011
}

\bigskip{\sf MODULE:}
\begin{verbatim}  module NUOPC_DriverAtmOcn
\end{verbatim}

\bigskip{\sf DESCRIPTION:\\}
Driver component that drives a coupled Atmosphere-Ocean model. The default is to use explicit time stepping. Each driver time step the same sequence of Atmosphere, Ocean and connector {\tt Run} methods are called. The run sequence is fully customizable.

\bigskip{\sf SUPER:}
\begin{verbatim}  NUOPC_Driver
\end{verbatim}

\bigskip{\sf USE DEPENDENCIES:}
\begin{verbatim}  use ESMF
\end{verbatim}

\bigskip{\sf SETSERVICES:}
\begin{verbatim}  subroutine routine_SetServices(gcomp, rc)
    type(ESMF_GridComp)   :: gcomp
    integer, intent(out)  :: rc
\end{verbatim}

\bigskip{\sf INITIALIZE:}
\begin{itemize}
\item phase 1: {\sc Provided:}
  \begin{itemize}
  \item Initialize the internal state.
  \item Set default internal clock to be a copy of the incoming clock.
  \item Set the number of model components to 2.
  \item Allocate internal storage according to {\tt modelCount = 2}.
  \item {\it Optional specialization} to provide model and connector {\tt petList} members in the internal state: {\tt label\_SetModelPetList}.
  \item Create {\tt atm} and {\tt ocn} Model components with their import and export States.
  \item Attach standard NUOPC Model Component metadata.
  \item Create {\tt atm2ocn} and {\tt ocn2atm} Connector components.
  \item Attach standard NUOPC Connector Component metadata.
  \item Initialize the default run sequence.
  \item {\it Required specialization} to set model component services: {\tt label\_SetModelServices}. 
  \begin{itemize}
    \item Call into SetServices() for the {\tt atm}, {\tt ocn}, {\tt atm2ocn}, and {\tt ocn2atm} components.
    \item Optionally replace the default clock. 
    \item Optionally replace the default run sequence.
  \end{itemize}
  \item Execute Initialize() phase 0 for {\tt atm}.
  \item Execute Initialize() phase 0 for {\tt ocn}.
  \item Execute Initialize() phase 0 for {\tt atm2ocn}.
  \item Execute Initialize() phase 0 for {\tt ocn2ocn}.
  \item Execute Initialize() phase 1 for {\tt atm}.
  \item Execute Initialize() phase 1 for {\tt ocn}.
  \item Execute Initialize() phase 1 for {\tt atm2ocn}.
  \item Execute Initialize() phase 1 for {\tt ocn2ocn}.
  \item Execute Initialize() phase 2 for {\tt atm}.
  \item Execute Initialize() phase 2 for {\tt ocn}.
  \item Execute Initialize() phase 3 for {\tt atm}.
  \item Execute Initialize() phase 3 for {\tt ocn}.
  \end{itemize}  
\end{itemize}

\bigskip{\sf RUN:}
\begin{itemize}
\item phase 1: {\sc Provided:}
  \begin{itemize}
  \item Time stepping loop, from current time to stop time, incrementing by time step.
  \item For each time step iteration, the Run() methods for {\tt atm}, {\tt ocn}, {\tt atm2ocn}, and {\tt ocn2atm} are being called according to the run sequence.
  \end{itemize}    
\end{itemize}

\bigskip{\sf FINALIZE:}
\begin{itemize}
\item phase 1: {\sc Provided:}
  \begin{itemize}
  \item {\it Optional specialization} to finalize driver component: {\tt label\_Finalize}.
  \item Execute Finalize() for {\tt atm2ocn} and {\tt ocn2atm}.
  \item Execute Finalize() for {\tt atm} and {\tt ocn}.
  \item Destroy {\tt atm} and {\tt ocn} and their import and export States.
  \item Destroy {\tt atm2ocn} and {\tt ocn2atm}.
  \item Deallocate the run sequence.
  \item Deallocate the internal state.
  \end{itemize}      
\end{itemize}

\bigskip{\sf INTERNALSTATE:}
\begin{verbatim}  label_InternalState

  type type_InternalState
    type(type_InternalStateStruct), pointer :: wrap
  end type

  type type_InternalStateStruct
    integer, pointer                  :: atmPetList(:)
    integer, pointer                  :: ocnPetList(:)
    type(ESMF_GridComp)               :: atm
    type(ESMF_GridComp)               :: ocn
    type(ESMF_State)                  :: atmIS, atmES
    type(ESMF_State)                  :: ocnIS, ocnES
    integer, pointer                  :: atm2ocnPetList(:)
    integer, pointer                  :: ocn2atmPetList(:)
    type(ESMF_CplComp)                :: atm2ocn, ocn2atm
    type(NUOPC_RunSequence), pointer  :: runSeq(:)
  end type

\end{verbatim}
%...............................................................

