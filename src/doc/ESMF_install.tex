% $Id: ESMF_install.tex,v 1.19 2003/04/10 03:42:31 cdeluca Exp $

\subsection{Downloading the ESMF Software}

Major releases of the ESMF software can be downloaded from the {\bf User Links and
Downloads} page on the ESMF website, \htmladdnormallink{http://www.esmf.ucar.edu}
{http://www.esmf.ucar.edu}.  

\subsection{Installation}
\label{InstallProcedures}

\input{ESMF_systemreq}

\subsubsection{ESMF Environment Variables}

The following environment variables must be set:
\begin{verbatim}
  ESMF_DIR      top-level ESMF directory
  ESMF_ARCH     platform and compiler configuration
\end{verbatim}

\subsubsection{Supported Platforms}
\input{user_arch.tex}

% GNU make requirement.  File in build/doc
\input{user_make.tex}

Simultaneous multiple architecture builds are supported, with
one restriction; the test cases may only be run on one platform at a time. 

\subsubsection{Building the ESMF Libraries}
\label{BuildESMF}

Build the library with the command:
\begin{verbatim}
  gmake BOPT=g  
\end{verbatim}
  for a debug version or
\begin{verbatim}
  gmake BOPT=O  
\end{verbatim}
  for an optimized version.

There is an install target which will copy the library and mod files to an
install location.  To invoke this target use:
\begin{verbatim}
  gmake BOPT=[O,g] ESMF_LIB_INSTALL=dir_for_lib ESMF_MOD_INSTALL=dir_for_mod_files install 
\end{verbatim}

Some users may wish for the library to be built in a directory different from 
where the source code resides.  To do this, build using:
\begin{verbatim}
   gmake ESMF_BUILD=build_directory_here BOPT=[O,g]
\end{verbatim}

The {\tt ESMF\_BUILD} variable gives an alternate path in which to place the libraries,
mod files and object files.  This variable defaults to {\tt ESMF\_DIR}.  If it is 
assigned another value, the {\tt ESMF\_BUILD} variable will need to be passed as
an additional argument to the the above make commands.  (Alternatively the variable
{\tt ESMF\_BUILD} can be set in the environment (using setenv or export) and then it 
need not be passed to any make calls).


\subsubsection{Building the ESMF Test Suites}
\label{BuildTestSuite}
A test suite is included with the library. Tests are provided for both MPI
and uniprocessor builds. Tests can be built both from the top ESMF directory and
the local source code directories.

\noindent The following command builds the System Tests:
\begin{verbatim}
  gmake BOPT=<g,O> [SYSTEM_TEST=NNNNN] build_system_tests
\end{verbatim}

For example:
\begin{verbatim}
  gmake BOPT=O build_system_tests
\end{verbatim}
Will build all available system tests. Specifying a specific SYSTEM\_TEST number will build only the specified system test.

\noindent The following command builds the Unit Tests:
\begin{verbatim}
  gmake BOPT=<g,O> [ESMF_EXHAUSTIVE=<ON,OFF>] build_tests
\end{verbatim}

For example:
\begin{verbatim}
  gmake BOPT=g ESMF_EXHAUSTIVE=OFF build_tests
\end{verbatim}
will build tests that verify basic correctness of the library build and installation. Turning the {\tt ESMF\_EXHAUSIVE} option {\tt ON} when building will create a more comprehensive set of tests, but, will take significantly longer to run. 

Output files from the test examples will be directed to files in:
\begin{verbatim}
  ${ESMF_DIR}/test${BOPT}/${ESMF_ARCH}
\end{verbatim}

See Section~\ref{TestingProcedures} for instruction on running ESMF tests.

\subsubsection{Building the ESMF Documentation}
\label{BuildDocumentation}

\noindent To build documentation:
\begin{verbatim}
  gmake dvi           ! Makes the dvi files.
  gmake pdf           ! Makes the pdf files.
  gmake html          ! Creates the html directory.
  gmake alldoc        ! Builds all the above documents.
\end{verbatim}

\noindent To build documentation for one module:

\noindent First change directory to the where the desired module's documentation resides;  for
example, to build the {\tt TimeMgmt} documentation start with:

\begin{verbatim}
cd ${ESMF_DIR}/src/Infrastructure/TimeMgmt/doc
\end{verbatim}

\noindent Next issue one of the following commands:
\begin{verbatim}
  gmake localdvi      ! Builds local dvi files.
  gmake localpdf      ! Builds local pdf files.
  gmake localhtml     ! Builds local html files.
  gmake localdoc      ! Builds all of the local documents.
\end{verbatim}

\noindent The output from this local documentation build is in the top level {\tt doc}
directory, as with the previous commands.






