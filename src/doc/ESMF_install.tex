% $Id: ESMF_install.tex,v 1.22 2003/05/07 14:14:38 cdeluca Exp $

\subsection{ESMF Download Options}

Major releases of the ESMF software can be downloaded by following
the instructions on the 
the {\bf Downloads \& Documentation} page on the ESMF 
website, \htmladdnormallink{http://www.esmf.ucar.edu}{http://www.esmf.ucar.edu}.  There are two options for using the ESMF:

\begin{itemize}
\item Download a pre-built ESMF shared object library and
test applications for a particular platform.  If you choose
this approach, you can skip ahead to Section~\ref{UsingLibrary},
Using the ESMF.  
\item Download the full ESMF source code, and compile and link
the framework to any necessary system libraries.  This will
result in a shared object file (with a *.so extension)
that can be linked in with the user's code, or with the demo
{ESMF\_COUPLED\_FLOW} executable.  In this case you will need
to follow all the instructions in subsequent sections of the 
{\it Quick Start} guide, beginning with Section~\ref{InstallProcedures},
Installation.
\end{itemize}

You may find it necessary to build the ESMF yourself
if we do not offer a shared object library for the current
version of your compiler.  The compiler versions that we offer
shared objects for are noted on the download web page.

\subsection{Installation}
\label{InstallProcedures}

\input{ESMF_systemreq}

\subsubsection{ESMF Environment Variables}

The following environment variables must be set:
\begin{verbatim}
  ESMF_DIR      top-level ESMF directory
  ESMF_ARCH     platform and compiler configuration
\end{verbatim}

\subsubsection{Supported Platforms}
\input{user_arch.tex}

% GNU make requirement.  File in build/doc
\input{user_make.tex}

Simultaneous multiple architecture builds are supported, with
one restriction; the test cases may only be run on one platform at a time. 

\subsubsection{Building the ESMF Libraries}
\label{BuildESMF}

Build the library with the command:
\begin{verbatim}
  gmake BOPT=g  
\end{verbatim}
  for a debug version or
\begin{verbatim}
  gmake BOPT=O  
\end{verbatim}
  for an optimized version.

Build options that enable you to copy the library and *.mod files to
specified directories are explained in Section~\ref{BuildOptions}. 

\subsubsection{Building the ESMF Test Suites}
\label{BuildTestSuite}
A test suite is included with the library. Tests are provided for both MPI
and uniprocessor builds. Tests can be built both from the top ESMF directory and
the local source code directories.

\noindent The following command builds the System Tests:
\begin{verbatim}
  gmake BOPT=<g,O> [SYSTEM_TEST=NNNNN] build_system_tests
\end{verbatim}

For example:
\begin{verbatim}
  gmake BOPT=O build_system_tests
\end{verbatim}
Will build all available system tests. Specifying a specific SYSTEM\_TEST number will build only the specified system test.

\noindent The following command builds the Unit Tests:
\begin{verbatim}
  gmake BOPT=<g,O> [ESMF_EXHAUSTIVE=<ON,OFF>] build_tests
\end{verbatim}

For example:
\begin{verbatim}
  gmake BOPT=g ESMF_EXHAUSTIVE=OFF build_tests
\end{verbatim}
will build tests that verify basic correctness of the library build and installation. Turning the {\tt ESMF\_EXHAUSIVE} option {\tt ON} when building will create a more comprehensive set of tests, but, will take significantly longer to run. 

Output files from the test examples will be directed to files in:
\begin{verbatim}
  ${ESMF_DIR}/test${BOPT}/${ESMF_ARCH}
\end{verbatim}

See Section~\ref{TestingProcedures} for instruction on running ESMF tests.

\subsubsection{Building the ESMF Documentation}
\label{BuildDocumentation}

\noindent To build documentation:
\begin{verbatim}
  gmake dvi           ! Makes the dvi files.
  gmake pdf           ! Makes the pdf files.
  gmake html          ! Creates the html directory.
  gmake alldoc        ! Builds all the above documents.
\end{verbatim}

\noindent To build documentation for one module:

\noindent First change directory to the where the desired module's documentation resides;  for
example, to build the {\tt TimeMgmt} documentation start with:

\begin{verbatim}
cd ${ESMF_DIR}/src/Infrastructure/TimeMgmt/doc
\end{verbatim}

\noindent Next issue one of the following commands:
\begin{verbatim}
  gmake localdvi      ! Builds local dvi files.
  gmake localpdf      ! Builds local pdf files.
  gmake localhtml     ! Builds local html files.
  gmake localdoc      ! Builds all of the local documents.
\end{verbatim}

\noindent The output from this local documentation build is in the top level {\tt doc}
directory, as with the previous commands.






