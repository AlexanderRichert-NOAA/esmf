% $Id: ESMF_install.tex,v 1.27 2003/05/30 21:18:37 flanigan Exp $

\subsection{ESMF Download Options}

Major releases of the ESMF software can be downloaded by following
the instructions on the 
the {\bf Downloads \& Documentation} page on the ESMF 
website, \htmladdnormallink{http://www.esmf.ucar.edu}{http://www.esmf.ucar.edu}.  There are two options for using the ESMF:

\begin{itemize}
\item Download a pre-built ESMF shared object library and
test applications for a particular platform.  If you choose
this approach, you can skip ahead to Section~\ref{UsingLibrary},
Using the ESMF.  
\item Download the full ESMF source code, and compile and link
the framework to any necessary system libraries.  This will
result in a shared object file (with a *.so extension)
that can be linked in with the user's code, or with the demo
{ESMF\_COUPLED\_FLOW} executable.  In this case you will need
to follow all the instructions in subsequent sections of the 
{\it Quick Start} guide, beginning with Section~\ref{InstallProcedures},
Installation.
\end{itemize}

You may find it necessary to build the ESMF yourself
if we do not offer a shared object library for the current
version of your compiler.  The compiler versions that we offer
shared objects for are noted on the download web page.

\subsection{Installation}
\label{InstallProcedures}

\input{ESMF_systemreq}

\subsubsection{ESMF Environment Variables}

The following environment variables must be set:
\begin{verbatim}
  ESMF_DIR      top-level ESMF directory
  ESMF_ARCH     platform and compiler configuration
\end{verbatim}

On Alpha machines an additional environment variable needs
to be set:

\begin{verbatim}
  ESMF_PROJECT  Load Sharing Facility (LSF) project name 
\end{verbatim}

On an Alpha machine, test and demo applications are run using 
the bsub command.  The value of ESMF\_PROJECT is used as the 
argument for bsub's -P option. The -P option assigns a job to 
a specific project.  

Environment variables must be set in the user's shell and not
inside an ESMF makefile or build system file.  Here is an example 
of setting an environment variable in tcsh and csh shells:
\begin{verbatim}
  setenv ESMF_ARCH rs6000_sp
\end{verbatim}
In ksh shell environment variables are set this way:
\begin{verbatim}
  export ESMF_ARCH=rs6000_sp
\end{verbatim}


\subsubsection{Supported Platforms}
\input{user_arch.tex}

Simultaneous multiple architecture builds are supported, with
one restriction; the test cases may only be run on one platform at a time. 

\subsubsection{Building the ESMF Libraries}
\label{BuildESMF}

Build the library with the command:
\begin{verbatim}
  gmake BOPT=g  
\end{verbatim}
  for a debug version or
\begin{verbatim}
  gmake BOPT=O  
\end{verbatim}
  for an optimized version.

% GNU make requirement.  File in build/doc
\input{user_make.tex}

Build options that enable you to copy the library and *.mod files to
specified directories are explained in Section~\ref{BuildOptions}. 

\subsubsection{Building the ESMF Documentation}
\label{BuildDocumentation}

\noindent To build documentation:
\begin{verbatim}
  gmake dvi           ! Makes the dvi files.
  gmake pdf           ! Makes the pdf files.
  gmake html          ! Creates the html directory.
  gmake alldoc        ! Builds all the above documents.
\end{verbatim}

\noindent To build documentation for one module:

\noindent First change directory to the where the desired module's documentation resides;  for
example, to build the {\tt TimeMgr} documentation start with:

\begin{verbatim}
cd ${ESMF_DIR}/src/Infrastructure/TimeMgr/doc
\end{verbatim}

\noindent Next issue one of the following commands:
\begin{verbatim}
  gmake dvi      ! Builds local dvi files.
  gmake pdf      ! Builds local pdf files.
  gmake html     ! Builds local html files.
  gmake alldoc   ! Builds all of the local documents.
\end{verbatim}

\noindent The output from this local documentation build is in the top level {\tt doc}
directory, as with the previous commands.






