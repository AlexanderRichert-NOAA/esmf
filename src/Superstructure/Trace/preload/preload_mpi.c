

/**
 *
 * preload_mpi.c
 *
 *  !! DO NOT EDIT !!
 *  This file was generated by gen_wrappers_mpi.py.
 *  !! DO NOT EDIT !!
 *
 * Functions that will be preloaded with LD_PRELOAD, thereby
 * overriding system library functions so we can call into our
 * wrapper function.
 *
 * Since we are using dynamic linking, the __real_<SYMBOL>
 * functions are looked up at runtime using dlsym().
 */

#include <dlfcn.h>
#include <mpi.h>

#include "ESMCI_Macros.h"
#include "ESMCI_Trace.h"
#include "wrappers_mpi.h"

#define xstr(s) str(s)
#define str(s) #s

extern "C" {

  /*
   * C MPI functions
   */

  
    static int (*__real_ptr_MPI_Allreduce)(const void *sendbuf, void *recvbuf, int count, MPI_Datatype datatype, MPI_Op op, MPI_Comm comm) = NULL;

    int __real_MPI_Allreduce(const void *sendbuf, void *recvbuf, int count, MPI_Datatype datatype, MPI_Op op, MPI_Comm comm) {
      if (__real_ptr_MPI_Allreduce == NULL) {
        __real_ptr_MPI_Allreduce = (int (*)(const void *sendbuf, void *recvbuf, int count, MPI_Datatype datatype, MPI_Op op, MPI_Comm comm)) dlsym(RTLD_NEXT, "MPI_Allreduce");
      }
      return __real_ptr_MPI_Allreduce(sendbuf, recvbuf, count, datatype, op, comm);
    }

    int MPI_Allreduce(const void *sendbuf, void *recvbuf, int count, MPI_Datatype datatype, MPI_Op op, MPI_Comm comm) {
      return __wrap_MPI_Allreduce(sendbuf, recvbuf, count, datatype, op, comm);
    }

  
    static int (*__real_ptr_MPI_Barrier)(MPI_Comm comm) = NULL;

    int __real_MPI_Barrier(MPI_Comm comm) {
      if (__real_ptr_MPI_Barrier == NULL) {
        __real_ptr_MPI_Barrier = (int (*)(MPI_Comm comm)) dlsym(RTLD_NEXT, "MPI_Barrier");
      }
      return __real_ptr_MPI_Barrier(comm);
    }

    int MPI_Barrier(MPI_Comm comm) {
      return __wrap_MPI_Barrier(comm);
    }

  
    static int (*__real_ptr_MPI_Wait)(MPI_Request *request, MPI_Status *status) = NULL;

    int __real_MPI_Wait(MPI_Request *request, MPI_Status *status) {
      if (__real_ptr_MPI_Wait == NULL) {
        __real_ptr_MPI_Wait = (int (*)(MPI_Request *request, MPI_Status *status)) dlsym(RTLD_NEXT, "MPI_Wait");
      }
      return __real_ptr_MPI_Wait(request, status);
    }

    int MPI_Wait(MPI_Request *request, MPI_Status *status) {
      return __wrap_MPI_Wait(request, status);
    }

  

  /*
   * Fortran MPI functions
   */

  
    static void (*FTN_X(__real_ptr_mpi_allgather))(MPI_Fint *sendbuf, MPI_Fint *sendcount, MPI_Fint *sendtype, MPI_Fint *recvbuf, MPI_Fint *recvcount, MPI_Fint *recvtype, MPI_Fint *comm, MPI_Fint *ierr) = NULL;

    void FTN_X(__real_mpi_allgather)(MPI_Fint *sendbuf, MPI_Fint *sendcount, MPI_Fint *sendtype, MPI_Fint *recvbuf, MPI_Fint *recvcount, MPI_Fint *recvtype, MPI_Fint *comm, MPI_Fint *ierr) {
      if (FTN_X(__real_ptr_mpi_allgather) == NULL) {
        FTN_X(__real_ptr_mpi_allgather) = (void (*)(MPI_Fint *sendbuf, MPI_Fint *sendcount, MPI_Fint *sendtype, MPI_Fint *recvbuf, MPI_Fint *recvcount, MPI_Fint *recvtype, MPI_Fint *comm, MPI_Fint *ierr)) dlsym(RTLD_NEXT, xstr(FTN_X(mpi_allgather)));
      }
      FTN_X(__real_ptr_mpi_allgather)(sendbuf, sendcount, sendtype, recvbuf, recvcount, recvtype, comm, ierr);
    }

    void FTN_X(mpi_allgather)(MPI_Fint *sendbuf, MPI_Fint *sendcount, MPI_Fint *sendtype, MPI_Fint *recvbuf, MPI_Fint *recvcount, MPI_Fint *recvtype, MPI_Fint *comm, MPI_Fint *ierr) {
      FTN_X(__wrap_mpi_allgather)(sendbuf, sendcount, sendtype, recvbuf, recvcount, recvtype, comm, ierr);
    }

  
    static void (*FTN_X(__real_ptr_mpi_allgatherv))(MPI_Fint *sendbuf, MPI_Fint *sendcount, MPI_Fint *sendtype, MPI_Fint *recvbuf, MPI_Fint *recvcount, MPI_Fint *displs, MPI_Fint *recvtype, MPI_Fint *comm, MPI_Fint *ierr) = NULL;

    void FTN_X(__real_mpi_allgatherv)(MPI_Fint *sendbuf, MPI_Fint *sendcount, MPI_Fint *sendtype, MPI_Fint *recvbuf, MPI_Fint *recvcount, MPI_Fint *displs, MPI_Fint *recvtype, MPI_Fint *comm, MPI_Fint *ierr) {
      if (FTN_X(__real_ptr_mpi_allgatherv) == NULL) {
        FTN_X(__real_ptr_mpi_allgatherv) = (void (*)(MPI_Fint *sendbuf, MPI_Fint *sendcount, MPI_Fint *sendtype, MPI_Fint *recvbuf, MPI_Fint *recvcount, MPI_Fint *displs, MPI_Fint *recvtype, MPI_Fint *comm, MPI_Fint *ierr)) dlsym(RTLD_NEXT, xstr(FTN_X(mpi_allgatherv)));
      }
      FTN_X(__real_ptr_mpi_allgatherv)(sendbuf, sendcount, sendtype, recvbuf, recvcount, displs, recvtype, comm, ierr);
    }

    void FTN_X(mpi_allgatherv)(MPI_Fint *sendbuf, MPI_Fint *sendcount, MPI_Fint *sendtype, MPI_Fint *recvbuf, MPI_Fint *recvcount, MPI_Fint *displs, MPI_Fint *recvtype, MPI_Fint *comm, MPI_Fint *ierr) {
      FTN_X(__wrap_mpi_allgatherv)(sendbuf, sendcount, sendtype, recvbuf, recvcount, displs, recvtype, comm, ierr);
    }

  
    static void (*FTN_X(__real_ptr_mpi_allreduce))(MPI_Fint *sendbuf, MPI_Fint *recvbuf, MPI_Fint *count, MPI_Fint *datatype, MPI_Fint *op, MPI_Fint *comm, MPI_Fint *ierr) = NULL;

    void FTN_X(__real_mpi_allreduce)(MPI_Fint *sendbuf, MPI_Fint *recvbuf, MPI_Fint *count, MPI_Fint *datatype, MPI_Fint *op, MPI_Fint *comm, MPI_Fint *ierr) {
      if (FTN_X(__real_ptr_mpi_allreduce) == NULL) {
        FTN_X(__real_ptr_mpi_allreduce) = (void (*)(MPI_Fint *sendbuf, MPI_Fint *recvbuf, MPI_Fint *count, MPI_Fint *datatype, MPI_Fint *op, MPI_Fint *comm, MPI_Fint *ierr)) dlsym(RTLD_NEXT, xstr(FTN_X(mpi_allreduce)));
      }
      FTN_X(__real_ptr_mpi_allreduce)(sendbuf, recvbuf, count, datatype, op, comm, ierr);
    }

    void FTN_X(mpi_allreduce)(MPI_Fint *sendbuf, MPI_Fint *recvbuf, MPI_Fint *count, MPI_Fint *datatype, MPI_Fint *op, MPI_Fint *comm, MPI_Fint *ierr) {
      FTN_X(__wrap_mpi_allreduce)(sendbuf, recvbuf, count, datatype, op, comm, ierr);
    }

  
    static void (*FTN_X(__real_ptr_mpi_barrier))(MPI_Fint *comm, MPI_Fint *ierr) = NULL;

    void FTN_X(__real_mpi_barrier)(MPI_Fint *comm, MPI_Fint *ierr) {
      if (FTN_X(__real_ptr_mpi_barrier) == NULL) {
        FTN_X(__real_ptr_mpi_barrier) = (void (*)(MPI_Fint *comm, MPI_Fint *ierr)) dlsym(RTLD_NEXT, xstr(FTN_X(mpi_barrier)));
      }
      FTN_X(__real_ptr_mpi_barrier)(comm, ierr);
    }

    void FTN_X(mpi_barrier)(MPI_Fint *comm, MPI_Fint *ierr) {
      FTN_X(__wrap_mpi_barrier)(comm, ierr);
    }

  
    static void (*FTN_X(__real_ptr_mpi_wait))(MPI_Fint *request, MPI_Fint *status, MPI_Fint *ierr) = NULL;

    void FTN_X(__real_mpi_wait)(MPI_Fint *request, MPI_Fint *status, MPI_Fint *ierr) {
      if (FTN_X(__real_ptr_mpi_wait) == NULL) {
        FTN_X(__real_ptr_mpi_wait) = (void (*)(MPI_Fint *request, MPI_Fint *status, MPI_Fint *ierr)) dlsym(RTLD_NEXT, xstr(FTN_X(mpi_wait)));
      }
      FTN_X(__real_ptr_mpi_wait)(request, status, ierr);
    }

    void FTN_X(mpi_wait)(MPI_Fint *request, MPI_Fint *status, MPI_Fint *ierr) {
      FTN_X(__wrap_mpi_wait)(request, status, ierr);
    }

  

}

