% $Id: Regrid_req.tex,v 1.2 2002/03/16 22:20:47 pwjones Exp $

%===============================================================================
% Requirements may be itemized under a main topic:
%===============================================================================
%===============================================================================
\req{General Regridding Requirements}
%-------------------------------------------------------------------------------

The following are general requirements for regridding operations.

%-------------------------------------------------------------------------------
\sreq{Creation}

Applications must be able to create a regridding and initialize
various time-independent regridding quantities.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:} All codes will require this. \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:} This function will, in many cases, be computing
             regridding weights and initializing various
             communication information for performing regridding.
\end{reqlist}

%-------------------------------------------------------------------------------
\sreq{Destruction}

Applications must be able to destroy regriddings to free up memory.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:} POP, CICE, CAM desired \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:}  
\end{reqlist}

%-------------------------------------------------------------------------------
\sreq{Support for ESMF Grids}

Regridding operations must be available for all supported ESMF grids,
including ungridded data.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:} All codes require this. \\
{\bf Status:} Proposed \\
{\bf Verification:} System test \\
{\bf Notes:} Not all regridding operations are appropriate for all
             grid types.
\end{reqlist}

%-------------------------------------------------------------------------------
\sreq{Multiple fields}

Regridding of multiple fields (bundles of fields) with
a single call must be supported.

\begin{reqlist}
{\bf Priority:} 2-3? \\
{\bf Source:} POP, CICE, CAM desired \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:} This should be supplied for efficiency, but may not
             be required to achieve functionality.
\end{reqlist}

%-------------------------------------------------------------------------------
\sreq{Consistency of coordinates}

Regridding will assume source and destination grids will be
in compatible coordinate systems.  This also applies to vertical
grid systems.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:} Required by all. \\
{\bf Status:} Proposed \\
{\bf Verification:} Code inspection  \\
{\bf Notes:} Supporting map projections from spherical to x-y grids is
             beyond the scope of ESMF.  Also, vertical regridding
             between all possible vertical grid systems is problematic.
\end{reqlist}

%-------------------------------------------------------------------------------
\sreq{Independence of field}

Regridding will be independent of the field being regridded.  For
higher-order regridding schemes which might require such information
(eg field gradients), the information must be passed as arguments.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:} Required by all. \\
{\bf Status:} Proposed \\
{\bf Verification:} Code inspection  \\
{\bf Notes:} If a way of passing user-defined functions
             were available, this requirement could be relaxed.
\end{reqlist}

%===============================================================================
\req{Regridding algorithms}
%-------------------------------------------------------------------------------

This section contains requirements on regridding algorithms themselves.

%-------------------------------------------------------------------------------
\sreq{Conservation}

At least one regridding method between two gridded fields must be
\htmlref{conservative}{glos:conservation}.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:} POP,CICE,CAM required \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:} The methods of Jones (1999, \cite{Jones1999}) can be used
             for 2-d fields. A Monte Carlo method could be used for
             3-d fields.  Obviously, conservation has no meaning
             for ungridded data.
\end{reqlist}

%-------------------------------------------------------------------------------
\sreq{Monotonicity}

At least one regridding method must be \htmlref{monotone}{glos:monotone}.

\begin{reqlist}
{\bf Priority:} 2-3? \\
{\bf Source:}  \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:} Biogeochemical models may need this.  First-order
             conservative schemes are generally monotone by
             construction, so this could be satisfied by the
             conservation requirement for gridded data.
\end{reqlist}


%-------------------------------------------------------------------------------
\sreq{Higher-order schemes}

At least one regridding method must be higher than first
\htmlref{order}{glos:order}.  This is required for preventing
``patchwork'' patterns when regridding from coarse to fine
methods and for preventing discontinuities in gradients of
regridded fields.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:}  POP, CICE, CAM required. \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:} This will require either internal approximations to
             gradients (eg bilinear) or will require user
             to pass such information.  See requirements on field
             dependence.
\end{reqlist}

%-------------------------------------------------------------------------------
\sreq{Spectral transforms}

Methods shall be supplied for regridding from physical space to
spectral space.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:}  \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:} Still not sure whether this is really the right place
             for this functionality.
             Lots of unknowns here, particularly related to
             spectral-space ordering and packing.
\end{reqlist}

%===============================================================================
\req{Other utilities}
%-------------------------------------------------------------------------------

The following are utilities required for regridding and could be made
public.

%-------------------------------------------------------------------------------
\sreq{Exchange grid}

A method for constructing a new grid formed by the intersecting
cells of two grids shall be available.

\begin{reqlist}
{\bf Priority:}  \\
{\bf Source:}  NSIPP \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:} 
\end{reqlist}

%-------------------------------------------------------------------------------
\sreq{Grid search}

Methods must be supplied which searches a grid to find the cell
containing a point or set of points.

\begin{reqlist}
{\bf Priority:} 1 \\
{\bf Source:}  \\
{\bf Status:} Proposed \\
{\bf Verification:} Unit test \\
{\bf Notes:} This is required for some of the above functions, but
             should it be here or in one of the other grid modules?
\end{reqlist}

