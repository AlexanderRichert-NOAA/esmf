% $Id: LogErr_cex.tex,v 1.1 2003/03/28 21:33:07 shep_smith Exp $
%
% Earth System Modeling Framework
% Copyright 2002-2003, University Corporation for Atmospheric Research, 
% Massachusetts Institute of Technology, Geophysical Fluid Dynamics 
% Laboratory, University of Michigan, National Centers for Environmental 
% Prediction, Los Alamos National Laboratory, Argonne National Laboratory, 
% NASA Goddard Space Flight Center.
% Licensed under the GPL.

%\subsection{C++ Use and Examples}

<Detailed examples of F90 usage of the class.>
\subsubsection{Example 1. Simple Example.}

In this example we initialize a Log object (aLog) and write a simple message
to standard out.

{\tt
\begin{verbatim}
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogMacros.inc"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogErr.C"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogConstants.inc"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_ErrConstants.inc"
ESMC_Log aLog;
int int_num=88;
aLog.ESMC_LogInit();
aLog.ESMC_LogInfo(aLog,"Hi there agent %d , int_num);
\end{verbatim}
}\tt

\subsubsection{Example 2. Simple Error Handling.}

Here we illustrate simple error handling.  Error output goes to the file anErr.txt
{\tt
\begin{verbatim}
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogErr.C"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogMacros.inc"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogConstants.inc"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_ErrConstants.inc"
ESMC_Log anErr;
type(ESMF_Log) :: anErr
int returnCode; 
anErr.ESMC_LogInit();
anErr.ESMC_LogOpenFile(anErr,ESMF_SINGLE_LOG_FILE,"anErr.txt");
returnCode=foo();
if (returnCode == ESMF_FATAL) anErr.ESMC_LogErr(anErr, ESMF_FATAL); 
anErr.ESMC_LogCloseFile();
\end{verbatim}
}\tt

\subsubsection{Example 3. More error handling. }

Here's an example combining writing to the log file and error handling.
All output to anErr.txt is flushed.  Initially, we halt execution on warnings, continue
execution on errors.  Later in the code we reverse this.

{\tt
\begin{verbatim}
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogErr.C"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogMacros.inc"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_LogConstants.inc"
#include "/home/sjs/ESMF/esmf/src/Infrastructure/LogErr/include/ESMF_ErrConstants.inc"
ESMC_Log anErr,aLog;
int returnCode; 
anErr.ESMC_LogInit(anErr,ESMF_LOG_FALSE,ESMF_TRUE,ESMF_LOG_TRUE)
aLog.ESMC_LogInit()
anErr.ESMC_LogOpenFile(ESMF_SINGLE_LOG_FILE,"anErr.txt")
aLog.ESMC_LogInfo('We are about to execute foo.');
returnCode=foo()
if (returnCode == ESMF_FATAL)  {
  anErr.ESMC_LogErrMsg(ESMF_FATAL,"Encountered an error, but keep going!");
}
returnCode=foo2()
if(returnCode == ESMF_WARNING) {
  anErr.ESMC_LogWarnMsg(ESMC_WARNING,"Encountered a warning, but we stop execution!");
}
anErr.ESMC_LogHaltOnErr();
anErr.ESMC_LogNotHaltOnWarn();
returnCode=foo();
if (returnCode == ESMF_FATAL) anErr.ESMC_LogErr(ESMF_FATAL);
returnCode=foo2();   //we never get here!
if(returnCode == ESMF_WARNING) anErr.ESMC_LogWarn(ESMC_WARNING);
anErr.ESMC_LogCloseFile(anErr);
\end{verbatim}
}\tt

