% $Id: Attribute_desc.tex,v 1.12 2008/10/20 22:13:28 rokuingh Exp $
%
% Earth System Modeling Framework
% Copyright 2002-2008, University Corporation for Atmospheric Research,
% Massachusetts Institute of Technology, Geophysical Fluid Dynamics
% Laboratory, University of Michigan, National Centers for Environmental
% Prediction, Los Alamos National Laboratory, Argonne National Laboratory,
% NASA Goddard Space Flight Center.
% Licensed under the University of Illinois-NCSA License.

The {\tt ESMF\_Attribute} class is used to hold the metadata for other ESMF objects.  This class can be used to build Attribute hierarchies which connect the Attributes of different ESMF classes.  The {\tt ESMF\_Attribute} class is also capable of allowing the representation of standard Attribute packages for a more unified description of an object.  All Attributes are consistent across all PETs of the object to which they are attached.  This class is only partially implemented in this release.

\subsubsection{Attribute Representation in ESMF}

Attributes are meant to be used as a tool for the user to help internally document their project.   Several ESMF objects are allowed to have Attributes associated with them, these objects are the following:

\begin{itemize}
\item Array
\item CplComp
\item GridComp
\item FieldBundle
\item Field
\item Grid
\item State
\end{itemize}

Each Attribute contains a name value pair in which the value can be any of several numeric, character, and logical types.  The allowable ESMF Attribute value types include:

\begin{itemize}
\item {\tt ESMF\_TYPEKIND\_I4}
\item {\tt ESMF\_TYPEKIND\_I4} list
\item {\tt ESMF\_TYPEKIND\_I8}
\item {\tt ESMF\_TYPEKIND\_I8} list
\item {\tt ESMF\_TYPEKIND\_R4}
\item {\tt ESMF\_TYPEKIND\_R4} list
\item {\tt ESMF\_TYPEKIND\_R8}
\item {\tt ESMF\_TYPEKIND\_R8} list
\item {\tt ESMF\_TYPEKIND\_Logical}
\item {\tt ESMF\_TYPEKIND\_Logical} list
\item {\tt EMSF\_TYPEKIND\_Character}
\item {\tt EMSF\_TYPEKIND\_Character} list
\end{itemize}

All Attributes also contain character strings specifying the convention, type, and object of the Attribute for the purpose of keeping track of Attribute packages.  All Attributes contain a list of pointers to other Attributes, which is empty until specified otherwise.  This list of Attribute pointers is what allows Attribute hierarchies to be built.  Using this feature an Attribute for one ESMF class can be linked to an Attribute in another ESMF class.

\subsubsection{Attribute Hierarchies}

Of these ESMF objects with Attributes, only some can link their Attributes together in an Attribute hierarchy.  These objects are:

\begin{itemize}
\item CplComp
\item GridComp
\item Field
\item FieldBundle
\item State
\end{itemize}

The most common use for this capability is for linking the Attributes of a Field to the FieldBundle which holds it, which is then linked to the State that is used to transport all of the data for a Component.  All of these links, with the exception of the link between the Component and the State, are done automatically by ESMF.  

Attribute hierarchies are linked with "shallow" copies, meaning that the Attributes belonging to an external object are not copied, they are only referenced by a pointer.  On this note, the function used to copy an Attribute hierarchy follows a similar practice of local "shallow" copying.  In this case the Attributes which {\it belong} to the object being copied are actually copied in full, while the Attributes which are linked to the object being copied are referenced by a pointer.  This means that after copying an Attribute hierarchy from ESMF object A to ESMF object B, the changes made to the lower portion of either A or B's Attribute hierarchy will be reflected on {\it both} object A and object B.

\subsubsection{Attribute Packages}

At this time, only select ESMF classes have Attribute packages.  Every Attribute package is specified by a {\bf convention} and a {\bf purpose}, hereafter called {\bf specifiers}, such as "CF" (see below) and "general".  These specifiers will be used much more rigorously in future releases to help incorporate many existing metadata standards.  In this release the user can use an ESMF supplied standard Attribute package, specify their own Attribute packages, or add customized Attributes to the ESMF supplied Attribute package.  Working with Attribute packages is quite involved, at present, but significant effort in automation of these metadata capabilities in ESMF is anticipated in future releases. 

The standard Attribute packages supplied by ESMF exist for the following ESMF objects:

\begin{itemize}
\item CplComp
\item GridComp
\item Field
\end{itemize}

The standard Attribute package for the Field is based on the Climate and Forecast (CF) convention, and consists of 6 Attributes.  Two of these Attributes are not CF compliant, but used by the Earth System Grid (ESG) data portal for metadata tracking and standardization.  These same two Attributes are part of an internal Attribute package on the ESMF State.  The four CF compliant Attributes that can be set by the user on an ESMF Field are:

\begin{itemize}
\item name
\item long\_name
\item standard\_name
\item units
\end{itemize}

The standard Attribute package for the Components is only partially based on the CF convention, the majority of the Attributes in this package are used by the ESG data portal.  These Attributes, which can all be set by the user, are:

\begin{itemize}
\item name
\item full\_name
\item version
\item discipline
\item physical\_domain
\item agency
\item institution
\item author
\item coding\_language
\item model\_component\_framework
\end{itemize}

The ESMF also allows nesting of Attribute packages.  This capability is meant to be used to organize different metadata compliance levels, such as CF and ESG.  The nesting of Attribute packages is also very helpful when adding customized Attributes to a package.  

The main use of the nesting capabilities of Attribute packages is geared towards organizing different metadata compliance levels.  For instance, the CF metadata standard for Fields requires that there be Attributes to track the {\it name}, {\it long\_name}, {\it standard\_name}, and {\it units} of the Field.  The ESG standard, on the other hand, requires two additional Attributes called {\it import} and {\it export}.  In this case the ESMF representation of the ESG compliant Attribute package for a Field would involve a nested Attribute package structure.  This would involve the ESG-specific Attribute package, containing the Attributes {\it import} and {\it export} nested inside the CF-specific Attribute package, containing the Attributes {\it name}, {\it long\_name}, {\it standard\_name}, and {\it units}.  A UML diagram will make this more clear.  

[UML diagram goes here]

The nesting capabilities of Attribute packages are also very useful for organizing the customized metadata supplied by a user.  For example, if a user was not satisfied with the metadata support required in the ESG convention for Field they could supply a list of Attributes they would like to support.  This new Attribute package would then be nested, in one additional layer, inside the Attribute package of ESG, which itself is nested inside the CF Attribute package.  This capability of nesting Attribute packages allows for a multitude of metadata organization strategies, and will also aid in the enforcement of metadata compliance when it is implemented in a future ESMF release.







