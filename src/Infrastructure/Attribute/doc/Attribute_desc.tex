% $Id: Attribute_desc.tex,v 1.47 2011/05/18 20:31:08 rokuingh Exp $
%
% Earth System Modeling Framework
% Copyright 2002-2011, University Corporation for Atmospheric Research,
% Massachusetts Institute of Technology, Geophysical Fluid Dynamics
% Laboratory, University of Michigan, National Centers for Environmental
% Prediction, Los Alamos National Laboratory, Argonne National Laboratory,
% NASA Goddard Space Flight Center.
% Licensed under the University of Illinois-NCSA License.


The ESMF Attribute class is a metadata utility that supports emerging standards 
in a flexible way.  The Attribute class is useful for documenting data 
provenance and encourages models to be more self describing.  Attributes can 
also be used for some aspects of model execution and coupling.

Metadata, which is data about data, is broken down into 
name-value pairs by the Attribute class.  Attributes can be attached at any 
level of the ESMF object hierarchy, and in some cases the Attributes of 
different ESMF objects can linked together to form 
a corresponding Attribute hierarchy.  Attribute hierarchies are linked up
automatically for the most part, with an exception at the Component-State 
interaction.  Attribute hierarchies can also be unlinked, copied, and 
moved around as needed.

ESMF Attribute packages 
are used to aggregate, store, and output model metadata.  They can be 
nested inside each other to make larger organized packages, distributed across 
processors and updated at runtime, and expanded to suite specific needs.  These 
Attribute packages are designed around accepted metadata conventions such as: 
climate and forecast (CF) \cite{ref:cf}, ISO standards \cite{ref:iso}, and the METAFOR 
Common Information Model (CIM) \cite{ref:cim}.

Most of the ESMF deep objects can host Attributes, and   
every object that can hold individual Attributes can also hold
Attribute packages.  Attribute hierarchies are supported for a majority of
the Attribute bearing classes.  
More information on the various Attribute 
capabilities, and the classes for which they are supported appear in the
following sections.

\subsubsection{The ESMF approach to Attributes}

ESMF's approach to Attributes can be summarized as follows:

\begin{itemize}
  \item Implement community standards where they exist
  \item Associate Attributes with the ESMF object they describe. Currently, the following ESMF objects can have Attributes:
  \begin{itemize}
     \item CplComp
     \item GridComp
     \item State
     \item FieldBundle
     \item Field
     \item ArrayBundle
     \item Array
     \item Grid
     \item DistGrid
     \end{itemize}
  \item Establish pre-defined Attribute packages (see Section \ref{sec:AttPacks}) to make Attribute creation easier for the user.
  \item Allow for user-defined custom Attribute packages (see Section \ref{sec:CustomAttPacks}).
  \item Enable the nesting of Attribute packages (see Section \ref{sec:AttPackNesting}) including Custom packages.
  \item Enable complex Attribute hierarchies (see Section \ref{sec:AttHier}.
  \item Export Attributes in more than one format (see Section \ref{sec:AttributeExports}).
  \item Ensure that all Attributes are consistent across the entire virtual machine of the object to which they are attached.
\end{itemize}

\subsubsection{Attribute hierarchies}
\label{sec:AttHier}

Of the ESMF objects with Attributes, only some can link their Attributes together in an Attribute hierarchy.  These objects are:

\begin{itemize}
\item CplComp
\item GridComp
\item State
\item FieldBundle
\item Field
\item ArrayBundle
\item Array
\end{itemize}

The most common use for this capability is for linking the Attributes of a 
Field to the FieldBundle which holds it, which is then linked to the State that 
is used to transport all of the data for a Component.  All of these links, with 
the exception of the link between the Component and the State, are 
automatically handled by ESMF. Additionally, the State will automatically set 
the {\tt VariableIntent} Attribute that is part of the ESMF supplied standard 
Attribute package for Field when that Field is added to the State.  {\tt 
VariableIntent} will be set to either {\tt Export} or {\tt Import}.

Every ESMF deep object is given a {\tt root} Attribute on creation.
These {\tt root} Attributes serve as the attachment point for all metadata that 
is stored on a particular ESMF object.  The {\tt root} Attributes can then be 
connected together, forming an Attribute hierarchy which mirrors the structure 
of the underlying object hierarchy.  In order to ensure consistency across a 
distributed system, a one-to-one correspondence of the Attribute and ESMF 
object hierarchies must be maintained.  This means that the Attribute 
hierarchies are linked together with pointers, and changes to a lower level 
Attribute hierarchy will be reflected on all higher level Attribute hierarchies 
that can access the one that was changed.