Coupled Flow Demo    -    README
--------------------------------

This README file provides instructions for how to build and run the Coupled
Flow Demo application. Detailed discussion of the internal workings of the
code, including its application of the ESMF API, are provided in the ESMF
User's Guide. The ESMF User's Guide is available online through the ESMF web
site at http://www.earthsystemmodeling.org/.

Building the Coupled Flow Demo Application
------------------------------------------

Follow these steps, starting from the src/demos/coupled_flow directory where
this README is located:

0) Set the ESMF environment variables according to the instruction
   given in the "BUILDING and INSTALLING the ESMF library" section found 
   in the main ESMF README file. For a more detailed discussion also consult
   the ESMF User's Guide.
   
   CAUTION: The coupled flow demo application requires that environment variable
            ESMF_PIO=internal, and ESMF_NETCDF and/or ESMF_PNETCDF are set
            during ESMF library and demo build time! Not having these variables
            set when building will result in crashes during demo execution.
   
1) cd src
2) gmake

Depending on whether the ESMF library has already been built, the "gmake"
command in step #2 will or will not build the ESMF library first. After
successful execution of the above steps the coupled flow demo application
will be located in the ESMF test directory structure.

Running the Coupled Flow Demo Application
-----------------------------------------

Currently the coupled flow demo only supports uni-PET execution. This is a
limitation that will be removed in future releases. To run the coupled flow
application in uni-PET mode follow these steps:

0) Ensure you are still located in src/demos/coupled_flow/src. This is the
   directory from where the demo was built in the previous section.
 
1) gmake run_uni

After successful execution of the coupled flow demo application a message will
be printed to stdout, indicating the location of the "CoupledFlowApp.stdout"
output file. Inspect this file for any output printed by the application to
stdout during execution.

All other output files generated by the coupled flow application will be
located in the local directory (i.e. src/demos/coupled_flow/src):

PET0.ESMF_LogFile   - ESMF log file containing all error messages logged.

DE.nc               - NetCDF file containing domain element
FLAG.nc             - NetCDF file containing flag of boundary conditions
OMEGA.nc            - NetCDF file containing vorticity
SIE.nc              - NetCDF file containing internal energy
U_velocity.nc       - NetCDF file containing U velocity
V_velocity.nc       - NetCDF file containing V velocity

The user can use standard NetCDF tools to analyze the data output files. Each
file stores an entire time series of the output variable. The tool "ncview" is
particularly useful to view time series in an animated form. Decreasing the 
"printout" value in the "coupled_flow_input" of the demo will increase the
frequency of data output, resulting in a smoother animation.

All output files are removed when executing "gmake clean" in the local demo src
directory.
